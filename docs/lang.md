## Полное описание возможностей и особенностей встроенного языка

Данный раздел является **справочно-учебным**. Он описывает язык целиком: синтаксис, семантику, ограничения и типовые особенности. Разделы можно читать выборочно.

---

## 1. Лексика и базовые правила языка (символы, ключевые слова, формат кода)

### 1.1 Регистр и язык ключевых слов

Язык **регистронезависим**:

- `#!bsl Если`, `#!bsl ЕСЛИ`, `#!bsl если` — эквивалентны.

Язык **двуязычный**:

- почти все ключевые слова имеют русское и английское написание;
- можно смешивать языки в одном модуле.

### 1.2 Идентификаторы

Имена переменных, процедур и функций:

- начинаются с буквы или `#!bsl _`;
- содержат буквы, цифры и `#!bsl _`;
- не должны совпадать с ключевыми словами языка;
- не должны совпадать с именами свойств/методов, доступных в текущем контексте.

Примеры корректных идентификаторов:
```bsl
Сумма
_ВнутреннийФлаг
СформироватьОтчет2024
```

### 1.3 Комментарии

Комментарий начинается с `#!bsl //` и заканчивается концом строки.

```bsl
// Это комментарий
Сумма = 10; // Комментарий после оператора
```

После `#!bsl //` на той же строке **нельзя** продолжать писать код.

### 1.4 Разделитель операторов

Операторы отделяются **точкой с запятой** `#!bsl ;`.

Конец строки **не завершает** оператор. Оператор может переноситься.

```bsl
Сумма = 1 +
        2 +
        3;
```

Можно писать несколько операторов в одной строке:
```bsl
A = 1; B = 2; C = A + B;
```

### 1.5 Метки и переходы

Метка — это специальный идентификатор, начинающийся с `#!bsl ~` и заканчивающийся `#!bsl :`.

```bsl
~Начало: A = 1;
```

Метки используются оператором `#!bsl Перейти` (аналог `#!bsl Goto`). Это редкий инструмент, применяйте только при реальной необходимости.

### 1.6 Специальные символы (что означает каждый)

- `#!bsl //` — комментарий до конца строки
- `#!bsl |` — перенос строки в многострочной строке (строка-продолжение)
- `#!bsl ~` — начало метки
- `#!bsl :` — конец метки
- `#!bsl ;` — разделитель операторов
- `#!bsl ()` — параметры вызова и управление приоритетом
- `#!bsl []` — доступ к свойству по имени / доступ к элементу коллекции
- `#!bsl ,` — разделитель параметров
- `#!bsl ""` — строковый литерал
- `#!bsl ''` — литерал даты
- `#!bsl .` — доступ к свойствам/методам
- `#!bsl + - * / %` — арифметика и/или конкатенация
- `#!bsl > >= < <= = <>` — сравнение

### 1.7 Ключевые слова (зарезервированные)

Эти слова нельзя использовать как имена переменных/процедур/функций.

Управление потоком:

- `#!bsl Если/If`, `#!bsl Тогда/Then`, `#!bsl ИначеЕсли/ElsIf`, `#!bsl Иначе/Else`, `#!bsl КонецЕсли/EndIf`
- `#!bsl Для/For`, `#!bsl Каждого/Each`, `#!bsl Из/In`, `#!bsl По/To`
- `#!bsl Пока/While`, `#!bsl Цикл/Do`, `#!bsl КонецЦикла/EndDo`
- `#!bsl Продолжить/Continue`, `#!bsl Прервать/Break`, `#!bsl Возврат/Return`
- `#!bsl Перейти/Goto`

Процедуры/функции и переменные:

- `#!bsl Процедура/Procedure`, `#!bsl КонецПроцедуры/EndProcedure`
- `#!bsl Функция/Function`, `#!bsl КонецФункции/EndFunction`
- `#!bsl Перем/Var`

Логика:

- `#!bsl И/And`, `#!bsl Или/Or`, `#!bsl Не/Not`

Исключения:

- `#!bsl Попытка/Try`, `#!bsl Исключение/Except`, `#!bsl КонецПопытки/EndTry`, `#!bsl ВызватьИсключение/Raise`

Прочее:

- `#!bsl Новый/New`
- `#!bsl Выполнить/Execute`
- `#!bsl Ждать/Await`

---

## 2. Типы данных и значения

### 2.1 Примитивные типы

**Число**

- десятичное;
- до 38 значащих цифр;

**Строка**

- Unicode;
- произвольной длины;
- поддерживает многострочные литералы.

**Дата**

- дата и время;
- точность до 0,1 мс;
- арифметика с секундами.

**Булево**

- `#!bsl Истина` / `#!bsl Ложь`;
- результат логических выражений.

**`#!bsl Неопределено`**

- отсутствие значения;
- используется по умолчанию.

**`#!bsl Null`**

- отсутствие данных БД;
- применяется при соединениях и запросах.

### 2.2 Тип`

Используется для:

- проверки типов;
- сравнения типов;
- динамической логики.

---

## 3. Выражения и вычисления (все операции с примерами)

Выражение — это формула, которая вычисляет значение. Выражения состоят из литералов, переменных, вызовов функций и операций.

### 3.1 Арифметические операции

> Ниже перечислены **все арифметические операции**, доступные в языке.

**Сложение `#!bsl +`**
```bsl
Сумма = 2 + 3; // 5
```
Определено для:

- `Число + Число`
- `Дата + Число` (число — секунды)
- 
```bsl
НоваяДата = '20240101' + 60; // +60 секунд
```

**Вычитание `-`**
```bsl
Разница = 10 - 4; // 6
```
Определено для:

- `Число - Число`
- `Дата - Число` (число — секунды)
- `Дата - Дата` (результат — секунды)

```bsl
Дата1 = '20240101';
Дата2 = '20240101';
Секунды = Дата1 - Дата2; // 0
```

**Умножение `#!bsl *`**
```bsl
Итог = 6 * 7; // 42
```

**Деление `#!bsl /`**
```bsl
Частное = 10 / 4; // 2.5
```

**Остаток от деления `#!bsl %`**
```bsl
Остаток = 10 % 3; // 1
```

**Унарный минус `#!bsl -`**
```bsl
X = -5;
Y = -(2 + 3); // -5
```

> Примечание: семантика операции определяется типом **первого операнда**. Если тип второго операнда не подходит, платформа пытается привести тип автоматически; если нельзя — возникает ошибка выполнения.

### 3.2 Операция конкатенации строк

Конкатенация использует тот же оператор `#!bsl +`.

```bsl
ФИО = Фамилия + " " + Имя + " " + Отчество;
```
Если правый операнд не строка, он будет преобразован к строке по правилам преобразования типов.

### 3.3 Операции сравнения

Операции сравнения возвращают **Булево**: `#!bsl Истина` или `#!bsl Ложь`.

**Больше `#!bsl >`**
```bsl
Рез = (10 > 5); // Истина
```

**Больше или равно `#!bsl >=`**
```bsl
Рез = (10 >= 10); // Истина
```

**Меньше `#!bsl <`**
```bsl
Рез = (3 < 2); // Ложь
```

**Меньше или равно `#!bsl <=`**
```bsl
Рез = (3 <= 3); // Истина
```

**Равно `#!bsl =`**
```bsl
Рез = ("A" = "A"); // Истина
```

**Не равно `#!bsl <>`**
```bsl
Рез = ("A" <> "B"); // Истина
```

Операции сравнения определены для:
- `Число`, `Строка`, `Дата` (для `#!bsl > >= < <=`)
- любых типов (для `#!bsl =` и `#!bsl <>`)

### 3.4 Булевы операции (логика)

**`#!bsl И` / `#!bsl And`**
```bsl
Рез = (Цена > 0) И (Количество > 0);
```

**`#!bsl Или` / `#!bsl Or`**
```bsl
Рез = (ЭтоАдмин) Или (ЭтоМенеджер);
```

**`#!bsl Не` / `#!bsl Not`**
```bsl
Рез = Не ЭтоАдмин;
```

**Короткое замыкание**
Вычисляются только необходимые части выражения.

```bsl
Если (Цена > 0) И ПроверкаСуммы() Тогда
    // Если Цена <= 0, функция ПроверкаСуммы() не вызовется
КонецЕсли;
```

### 3.5 Приоритет операций

Операторы с одинаковым приоритетом вычисляются слева направо.

1. Скобки: `#!bsl ()`
2. `#!bsl Не`
3. `#!bsl И`
4. `#!bsl Или`
5. Сравнение: `#!bsl < <= = >= > <>`
6. `#!bsl + -`
7. `#!bsl * / %`
8. Унарные: `#!bsl - +`
9. Доступ/вызов: `#!bsl .` и `#!bsl ()`

Практическое правило:

- если есть сомнения — ставьте скобки.

---

## 4. Операторы управления (все базовые конструкции с примерами)

### 4.1 Условие: `#!bsl Если` / `#!bsl ИначеЕсли` / `#!bsl Иначе`

```bsl
Если Сумма > 1000 Тогда
    Сообщить("Скидка применена");
ИначеЕсли Сумма > 0 Тогда
    Сообщить("Без скидки");
Иначе
    Сообщить("Сумма не задана");
КонецЕсли;
```

### 4.2 Цикл `#!bsl Для ... По ...`

Числовой цикл.

```bsl
Для i = 1 По 5 Цикл
    Сообщить(i);
КонецЦикла;
```

Шаг цикла задать невозможно, шак всегда равен `#!bsl 1`;

### 4.3 Цикл `#!bsl Для Каждого ... Из ...`

Обход коллекций.

```bsl
Для Каждого Элемент Из Коллекция Цикл
    Сообщить(Элемент);
КонецЦикла;
```

### 4.4 Цикл `#!bsl Пока ...`

Цикл с предусловием.

```bsl
Пока Счетчик < 3 Цикл
    Счетчик = Счетчик + 1;
КонецЦикла;
```

### 4.5 Управление циклом

**`#!bsl Продолжить`** — перейти к следующей итерации:
```bsl
Для Индекс = 1 По 5 Цикл
    Если Индекс = 3 Тогда
        Продолжить;
    КонецЕсли;
    Сообщить(Индекс); // выведет 1,2,4,5
КонецЦикла;
```

**`#!bsl Прервать`** — выйти из цикла:
```bsl
Для Индекс = 1 По 5 Цикл
    Если Индекс = 3 Тогда
        Прервать;
    КонецЕсли;
КонецЦикла;
```

### 4.6 Возврат из функции

`#!bsl Возврат` завершает функцию и возвращает значение.

```bsl
Функция Макс(А, Б)
    Если А > Б Тогда
        Возврат А;
    Иначе
        Возврат Б;
    КонецЕсли;
КонецФункции
```

### 4.7 Переход `#!bsl Перейти` (`#!bsl Goto`)

Используйте только если действительно нужен линейный сценарий с редкими ветвлениями.

```bsl
A = 0;
Перейти ~Конец;
A = 1; // не выполнится
~Конец:
Сообщить(A); // 0
```

### 4.8 Исключения: `#!bsl Попытка` / `#!bsl Исключение` / `#!bsl ВызватьИсключение`

```bsl
Попытка
    // потенциально опасный код
    Рез = 10 / 0;
Исключение
    Сообщить("Произошла ошибка");
КонецПопытки;
```

Явный выброс исключения:
```bsl
Если Сумма <= 0 Тогда
    ВызватьИсключение "Сумма должна быть больше 0";
КонецЕсли;
```

### 4.9 `#!bsl Новый` (создание объекта)

`#!bsl Новый` создает объект указанного типа.

```bsl
М = Новый Массив;
```

> Конкретные имена типов объектов зависят от доступного контекста (платформа и конфигурация).

### 4.10 `#!bsl Выполнить` (`#!bsl Execute`)

Выполняет строку как код.

```bsl
ТекстКода = "A = 1;";
Выполнить(ТекстКода);
```

> Используйте осторожно: ухудшает читаемость, сложнее отлаживать, повышает риск ошибок.

### 4.11 `#!bsl Ждать` (`#!bsl Await`)

Ключевое слово языка для ожидания (использование зависит от поддерживаемых механизмов в окружении).

---

## 5. Процедуры и функции

### 5.1 Процедуры

- выполняют действие;
- не возвращают значение;
- могут быть экспортируемыми.

### 5.2 Функции

- возвращают значение через `#!bsl Возврат`;
- могут использоваться в выражениях;
- допускают досрочный возврат.

### 5.3 Параметры

- по значению (по умолчанию);
- по ссылке;
- значения по умолчанию.

---

## 6. Программный модуль

### 6.1 Разделы модуля

1. Переменные (`#!bsl Перем`)
2. Процедуры и функции
3. Основной код (инициализация)

### 6.2 Метки и переходы

- метки начинаются с `#!bsl ~`;
- используются оператором `#!bsl Перейти`;
- применяются лучше никогда :).

---

## 7. Контекст выполнения

### 7.1 Глобальный контекст

- функции платформы;
- системные перечисления;
- глобальные общие модули.

### 7.2 Локальный контекст

Зависит от:

- типа модуля;
- объекта конфигурации;
- режима запуска.

---

## 8. Клиент-серверная модель

### 8.1 Среды выполнения

- клиентское приложение;
- сервер приложения.

### 8.2 Директивы компиляции

- `#!bsl &НаКлиенте`
- `#!bsl &НаСервере`
- `#!bsl &НаСервереБезКонтекста`
- `#!bsl &НаКлиентеНаСервере`

Директива:

- определяет место выполнения;
- влияет на доступные данные;
- влияет на сетевые вызовы.

---

## 9. Препроцессор

### 9.1 Назначение

- исключение кода;
- платформозависимая логика;
- группировка.

### 9.2 Инструкции

- `#!bsl #Если / #Иначе / #КонецЕсли`
- `#!bsl #Область / #КонецОбласти`
- `#!bsl #Вставка / #Удаление`

Препроцессор выполняется **до компиляции**.

---

## 10. Аннотации

- `#!bsl &Перед`
- `#!bsl &После`
- `#!bsl &Вместо`
- `#!bsl &ИзменениеИКонтроль`

Используются только в расширениях.

---

## 11. Особенности и ограничения языка

- динамическая типизация;
- отсутствие классов в классическом смысле;
- сильная зависимость от контекста;
- ориентация на бизнес-логику;
- высокая роль архитектурных решений.

---

## Итог

Встроенный язык:

- прост синтаксически;
- сложен контекстуально;
- требует архитектурного мышления.

Его нужно изучать **не как язык общего назначения**, а как инструмент платформы.

Встроенный язык:

- простой по синтаксису;
- строгий по контексту;
- ориентирован на бизнес-логику.

Главное для начинающего:

- понимать, **где выполняется код**;
- понимать, **в каком контексте** он работает;
- писать простой и читаемый код.
